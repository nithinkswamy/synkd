{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { WebPlugin } from './index';\nvar LocalNotificationsPluginWeb = /** @class */function (_super) {\n  __extends(LocalNotificationsPluginWeb, _super);\n  function LocalNotificationsPluginWeb() {\n    var _this = _super.call(this, {\n      name: 'LocalNotifications',\n      platforms: ['web']\n    }) || this;\n    _this.pending = [];\n    return _this;\n  }\n  LocalNotificationsPluginWeb.prototype.createChannel = function (channel) {\n    throw new Error('Feature not available in the browser. ' + channel.id);\n  };\n  LocalNotificationsPluginWeb.prototype.deleteChannel = function (channel) {\n    throw new Error('Feature not available in the browser. ' + channel.id);\n  };\n  LocalNotificationsPluginWeb.prototype.listChannels = function () {\n    throw new Error('Feature not available in the browser');\n  };\n  LocalNotificationsPluginWeb.prototype.sendPending = function () {\n    var _this = this;\n    var toRemove = [];\n    var now = +new Date();\n    this.pending.forEach(function (localNotification) {\n      if (localNotification.schedule && localNotification.schedule.at) {\n        if (+localNotification.schedule.at <= now) {\n          _this.buildNotification(localNotification);\n          toRemove.push(localNotification);\n        }\n      }\n    });\n    console.log('Sent pending, removing', toRemove);\n    this.pending = this.pending.filter(function (localNotification) {\n      return !toRemove.find(function (ln) {\n        return ln === localNotification;\n      });\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.sendNotification = function (localNotification) {\n    var _this = this;\n    var l = localNotification;\n    if (localNotification.schedule && localNotification.schedule.at) {\n      var diff = +localNotification.schedule.at - +new Date();\n      this.pending.push(l);\n      setTimeout(function () {\n        _this.sendPending();\n      }, diff);\n      return;\n    }\n    this.buildNotification(localNotification);\n  };\n  LocalNotificationsPluginWeb.prototype.buildNotification = function (localNotification) {\n    var l = localNotification;\n    return new Notification(l.title, {\n      body: l.body\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.schedule = function (options) {\n    var _this = this;\n    var notifications = [];\n    options.notifications.forEach(function (notification) {\n      notifications.push(_this.sendNotification(notification));\n    });\n    return Promise.resolve({\n      notifications: options.notifications.map(function (notification) {\n        return {\n          id: '' + notification.id\n        };\n      })\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.getPending = function () {\n    return Promise.resolve({\n      notifications: this.pending.map(function (localNotification) {\n        return {\n          id: '' + localNotification.id\n        };\n      })\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.registerActionTypes = function (_options) {\n    throw new Error('Method not implemented.');\n  };\n  LocalNotificationsPluginWeb.prototype.cancel = function (pending) {\n    console.log('Cancel these', pending);\n    this.pending = this.pending.filter(function (localNotification) {\n      return !pending.notifications.find(function (ln) {\n        return ln.id === '' + localNotification.id;\n      });\n    });\n    return Promise.resolve();\n  };\n  LocalNotificationsPluginWeb.prototype.areEnabled = function () {\n    return Promise.resolve({\n      value: Notification.permission === 'granted'\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.requestPermission = function () {\n    return new Promise(function (resolve) {\n      Notification.requestPermission(function (result) {\n        var granted = true;\n        if (result === 'denied' || result === 'default') {\n          granted = false;\n        }\n        resolve({\n          granted: granted\n        });\n      });\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.requestPermissions = function () {\n    return new Promise(function (resolve, reject) {\n      Notification.requestPermission(function (result) {\n        if (result === 'denied' || result === 'default') {\n          reject(result);\n          return;\n        }\n        resolve({\n          results: [result]\n        });\n      });\n    });\n  };\n  return LocalNotificationsPluginWeb;\n}(WebPlugin);\nexport { LocalNotificationsPluginWeb };\nvar LocalNotifications = new LocalNotificationsPluginWeb();\nexport { LocalNotifications };","map":{"version":3,"sources":["../../../src/web/local-notifications.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __extends } from \"tslib\";\nimport { WebPlugin } from './index';\nvar LocalNotificationsPluginWeb = /** @class */ (function (_super) {\n    __extends(LocalNotificationsPluginWeb, _super);\n    function LocalNotificationsPluginWeb() {\n        var _this = _super.call(this, {\n            name: 'LocalNotifications',\n            platforms: ['web']\n        }) || this;\n        _this.pending = [];\n        return _this;\n    }\n    LocalNotificationsPluginWeb.prototype.createChannel = function (channel) {\n        throw new Error('Feature not available in the browser. ' + channel.id);\n    };\n    LocalNotificationsPluginWeb.prototype.deleteChannel = function (channel) {\n        throw new Error('Feature not available in the browser. ' + channel.id);\n    };\n    LocalNotificationsPluginWeb.prototype.listChannels = function () {\n        throw new Error('Feature not available in the browser');\n    };\n    LocalNotificationsPluginWeb.prototype.sendPending = function () {\n        var _this = this;\n        var toRemove = [];\n        var now = +new Date;\n        this.pending.forEach(function (localNotification) {\n            if (localNotification.schedule && localNotification.schedule.at) {\n                if (+localNotification.schedule.at <= now) {\n                    _this.buildNotification(localNotification);\n                    toRemove.push(localNotification);\n                }\n            }\n        });\n        console.log('Sent pending, removing', toRemove);\n        this.pending = this.pending.filter(function (localNotification) { return !toRemove.find(function (ln) { return ln === localNotification; }); });\n    };\n    LocalNotificationsPluginWeb.prototype.sendNotification = function (localNotification) {\n        var _this = this;\n        var l = localNotification;\n        if (localNotification.schedule && localNotification.schedule.at) {\n            var diff = +localNotification.schedule.at - +new Date;\n            this.pending.push(l);\n            setTimeout(function () {\n                _this.sendPending();\n            }, diff);\n            return;\n        }\n        this.buildNotification(localNotification);\n    };\n    LocalNotificationsPluginWeb.prototype.buildNotification = function (localNotification) {\n        var l = localNotification;\n        return new Notification(l.title, {\n            body: l.body\n        });\n    };\n    LocalNotificationsPluginWeb.prototype.schedule = function (options) {\n        var _this = this;\n        var notifications = [];\n        options.notifications.forEach(function (notification) {\n            notifications.push(_this.sendNotification(notification));\n        });\n        return Promise.resolve({\n            notifications: options.notifications.map(function (notification) { return { id: '' + notification.id }; })\n        });\n    };\n    LocalNotificationsPluginWeb.prototype.getPending = function () {\n        return Promise.resolve({\n            notifications: this.pending.map(function (localNotification) {\n                return {\n                    id: '' + localNotification.id\n                };\n            })\n        });\n    };\n    LocalNotificationsPluginWeb.prototype.registerActionTypes = function (_options) {\n        throw new Error('Method not implemented.');\n    };\n    LocalNotificationsPluginWeb.prototype.cancel = function (pending) {\n        console.log('Cancel these', pending);\n        this.pending = this.pending.filter(function (localNotification) { return !pending.notifications.find(function (ln) { return ln.id === '' + localNotification.id; }); });\n        return Promise.resolve();\n    };\n    LocalNotificationsPluginWeb.prototype.areEnabled = function () {\n        return Promise.resolve({\n            value: Notification.permission === 'granted'\n        });\n    };\n    LocalNotificationsPluginWeb.prototype.requestPermission = function () {\n        return new Promise(function (resolve) {\n            Notification.requestPermission(function (result) {\n                var granted = true;\n                if (result === 'denied' || result === 'default') {\n                    granted = false;\n                }\n                resolve({ granted: granted });\n            });\n        });\n    };\n    LocalNotificationsPluginWeb.prototype.requestPermissions = function () {\n        return new Promise(function (resolve, reject) {\n            Notification.requestPermission(function (result) {\n                if (result === 'denied' || result === 'default') {\n                    reject(result);\n                    return;\n                }\n                resolve({\n                    results: [result]\n                });\n            });\n        });\n    };\n    return LocalNotificationsPluginWeb;\n}(WebPlugin));\nexport { LocalNotificationsPluginWeb };\nvar LocalNotifications = new LocalNotificationsPluginWeb();\nexport { LocalNotifications };\n//# sourceMappingURL=local-notifications.js.map"]},"metadata":{},"sourceType":"module"}