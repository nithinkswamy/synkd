{"ast":null,"code":"import { __awaiter, __extends, __generator } from \"tslib\";\nimport { WebPlugin } from './index';\nimport { uuid4 } from '../util';\nvar DevicePluginWeb = /** @class */function (_super) {\n  __extends(DevicePluginWeb, _super);\n  function DevicePluginWeb() {\n    return _super.call(this, {\n      name: 'Device',\n      platforms: ['web']\n    }) || this;\n  }\n  DevicePluginWeb.prototype.getInfo = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var ua, uaFields;\n      return __generator(this, function (_a) {\n        ua = navigator.userAgent;\n        uaFields = this.parseUa(ua);\n        return [2 /*return*/, Promise.resolve({\n          model: uaFields.model,\n          platform: 'web',\n          appVersion: '',\n          appBuild: '',\n          appId: '',\n          appName: '',\n          operatingSystem: uaFields.operatingSystem,\n          osVersion: uaFields.osVersion,\n          manufacturer: navigator.vendor,\n          isVirtual: false,\n          uuid: this.getUid()\n        })];\n      });\n    });\n  };\n  DevicePluginWeb.prototype.getBatteryInfo = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var battery, e_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            battery = {};\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n            return [4 /*yield*/, navigator.getBattery()];\n          case 2:\n            battery = _a.sent();\n            return [3 /*break*/, 4];\n          case 3:\n            e_1 = _a.sent();\n            return [3 /*break*/, 4];\n          case 4:\n            return [2 /*return*/, Promise.resolve({\n              batteryLevel: battery.level,\n              isCharging: battery.charging\n            })];\n        }\n      });\n    });\n  };\n  DevicePluginWeb.prototype.getLanguageCode = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2 /*return*/, {\n          value: navigator.language\n        }];\n      });\n    });\n  };\n  DevicePluginWeb.prototype.parseUa = function (_ua) {\n    var uaFields = {};\n    var start = _ua.indexOf('(') + 1;\n    var end = _ua.indexOf(') AppleWebKit');\n    if (_ua.indexOf(') Gecko') !== -1) {\n      end = _ua.indexOf(') Gecko');\n    }\n    var fields = _ua.substring(start, end);\n    if (_ua.indexOf('Android') !== -1) {\n      uaFields.model = fields.replace('; wv', '').split('; ').pop().split(' Build')[0];\n      uaFields.osVersion = fields.split('; ')[1];\n    } else {\n      uaFields.model = fields.split('; ')[0];\n      if (navigator.oscpu) {\n        uaFields.osVersion = navigator.oscpu;\n      } else {\n        if (_ua.indexOf('Windows') !== -1) {\n          uaFields.osVersion = fields;\n        } else {\n          var lastParts = fields.split('; ').pop().replace(' like Mac OS X', '').split(' ');\n          uaFields.osVersion = lastParts[lastParts.length - 1].replace(/_/g, '.');\n        }\n      }\n    }\n    if (/android/i.test(_ua)) {\n      uaFields.operatingSystem = 'android';\n    } else if (/iPad|iPhone|iPod/.test(_ua) && !window.MSStream) {\n      uaFields.operatingSystem = 'ios';\n    } else if (/Win/.test(_ua)) {\n      uaFields.operatingSystem = 'windows';\n    } else if (/Mac/i.test(_ua)) {\n      uaFields.operatingSystem = 'mac';\n    } else {\n      uaFields.operatingSystem = 'unknown';\n    }\n    return uaFields;\n  };\n  DevicePluginWeb.prototype.getUid = function () {\n    var uid = window.localStorage.getItem('_capuid');\n    if (uid) {\n      return uid;\n    }\n    uid = uuid4();\n    window.localStorage.setItem('_capuid', uid);\n    return uid;\n  };\n  return DevicePluginWeb;\n}(WebPlugin);\nexport { DevicePluginWeb };\nvar Device = new DevicePluginWeb();\nexport { Device };","map":{"version":3,"sources":["../../../src/web/device.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __awaiter, __extends, __generator } from \"tslib\";\nimport { WebPlugin } from './index';\nimport { uuid4 } from '../util';\nvar DevicePluginWeb = /** @class */ (function (_super) {\n    __extends(DevicePluginWeb, _super);\n    function DevicePluginWeb() {\n        return _super.call(this, {\n            name: 'Device',\n            platforms: ['web']\n        }) || this;\n    }\n    DevicePluginWeb.prototype.getInfo = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var ua, uaFields;\n            return __generator(this, function (_a) {\n                ua = navigator.userAgent;\n                uaFields = this.parseUa(ua);\n                return [2 /*return*/, Promise.resolve({\n                        model: uaFields.model,\n                        platform: 'web',\n                        appVersion: '',\n                        appBuild: '',\n                        appId: '',\n                        appName: '',\n                        operatingSystem: uaFields.operatingSystem,\n                        osVersion: uaFields.osVersion,\n                        manufacturer: navigator.vendor,\n                        isVirtual: false,\n                        uuid: this.getUid()\n                    })];\n            });\n        });\n    };\n    DevicePluginWeb.prototype.getBatteryInfo = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var battery, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        battery = {};\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, navigator.getBattery()];\n                    case 2:\n                        battery = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/, Promise.resolve({\n                            batteryLevel: battery.level,\n                            isCharging: battery.charging\n                        })];\n                }\n            });\n        });\n    };\n    DevicePluginWeb.prototype.getLanguageCode = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, {\n                        value: navigator.language\n                    }];\n            });\n        });\n    };\n    DevicePluginWeb.prototype.parseUa = function (_ua) {\n        var uaFields = {};\n        var start = _ua.indexOf('(') + 1;\n        var end = _ua.indexOf(') AppleWebKit');\n        if (_ua.indexOf(') Gecko') !== -1) {\n            end = _ua.indexOf(') Gecko');\n        }\n        var fields = _ua.substring(start, end);\n        if (_ua.indexOf('Android') !== -1) {\n            uaFields.model = fields.replace('; wv', '').split('; ').pop().split(' Build')[0];\n            uaFields.osVersion = fields.split('; ')[1];\n        }\n        else {\n            uaFields.model = fields.split('; ')[0];\n            if (navigator.oscpu) {\n                uaFields.osVersion = navigator.oscpu;\n            }\n            else {\n                if (_ua.indexOf('Windows') !== -1) {\n                    uaFields.osVersion = fields;\n                }\n                else {\n                    var lastParts = fields.split('; ').pop().replace(' like Mac OS X', '').split(' ');\n                    uaFields.osVersion = lastParts[lastParts.length - 1].replace(/_/g, '.');\n                }\n            }\n        }\n        if (/android/i.test(_ua)) {\n            uaFields.operatingSystem = 'android';\n        }\n        else if (/iPad|iPhone|iPod/.test(_ua) && !window.MSStream) {\n            uaFields.operatingSystem = 'ios';\n        }\n        else if (/Win/.test(_ua)) {\n            uaFields.operatingSystem = 'windows';\n        }\n        else if (/Mac/i.test(_ua)) {\n            uaFields.operatingSystem = 'mac';\n        }\n        else {\n            uaFields.operatingSystem = 'unknown';\n        }\n        return uaFields;\n    };\n    DevicePluginWeb.prototype.getUid = function () {\n        var uid = window.localStorage.getItem('_capuid');\n        if (uid) {\n            return uid;\n        }\n        uid = uuid4();\n        window.localStorage.setItem('_capuid', uid);\n        return uid;\n    };\n    return DevicePluginWeb;\n}(WebPlugin));\nexport { DevicePluginWeb };\nvar Device = new DevicePluginWeb();\nexport { Device };\n//# sourceMappingURL=device.js.map"]},"metadata":{},"sourceType":"module"}